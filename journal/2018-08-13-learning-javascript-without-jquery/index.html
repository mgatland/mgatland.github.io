<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Learning JavaScript without JQuery</title>
  
  <link href='//fonts.googleapis.com/css?family=PT+Serif:400,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/prism.css">
  <link rel="stylesheet" href="/css/stark.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width">
  

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-707544-6']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.  async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www'  ) + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(  ga, s);
    })();
  </script>

</head>
<body>
  	<div class="bar">
		<div class="title"><a href="/">Matthew Gatland</a></div>
		<nav>
			<a href="/games/">Games</a>
			<a href="/projects/">Projects</a>
			<a href="/journal/">Journal</a>
			<a href="/contact/">Contact</a>
		</nav>
	</div>
	<section class="content">
  <div class="journal">
    <div>
    	<h2>Learning JavaScript without JQuery</h2>
    	<div class="subtle">August&nbsp;13,&nbsp;2018</div>
    </div>
    
<p>I’m updating the <a href="https://girlcode.co.nz">Girl Code</a> activities to no longer use jQuery. jQuery is less trendy and popular every year, and we need to teach our students stuff that will help them look good when they talk to experienced developers.</p>
<p>When we started, some simple tasks were just too complex without jQuery – in particular, making a GET request went from this:</p>
<pre class="language-javascript"><code class="language-javascript">$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"/report"</span><span class="token punctuation">,</span> processReport<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>to this:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'json'</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'/report'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> jsonResponse <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
    <span class="token function">processReport</span><span class="token punctuation">(</span>jsonResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>What a mess! For a student who’s trying to remember what ‘GET’ and ‘POST’ mean, the jQuery example is so much better.</p>
<p>But the web has matured, and in most browsers a GET request can now look like this:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/report"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>processReport<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We can work with that. It’s still not as good as the jQuery way – it doesn’t use the key word ‘GET’, and it introduces promises and JSON, concepts that we don’t want to teach at this point. But it’s short and inoffensive and it’ll be fine.</p>
<p>(Note that I’m not a JS expert, and there just the best examples I’ve found so far. Feel free to email me if you have something that’s better! By better I mean: <i>it requires understanding fewer concepts</i>.)</p>
<p>So anyway, the most essential thing you’ll ever want to do in JavaScript is create HTML and add it into a page. With vanilla JS, I haven’t found a way to do this that I like. I’ve found ways that are not too bad. Here are the alternatives I’ve come up with so far:</p>
<p>The step by step approach:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage1</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> postElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  postElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"post"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> messageElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageElement<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> message<span class="token punctuation">;</span>

  postElement<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>messageElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>postElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>I personally like this, because it forces students to think of HTML as a tree instead of text. But it’s a bit unfair to make them construct HTML in such an abstract way when they’ve only just learned how to write it the normal way.</p>
<p>Using a DOMParser:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage2</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> postElement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseFromString</span><span class="token punctuation">(</span><span class="token string">'&lt;div class="post">&lt;div class="message">'</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">'&lt;/div>&lt;/div>'</span><span class="token punctuation">,</span> <span class="token string">'text/html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>body<span class="token punctuation">;</span>

  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>postElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This is pretty good. It’s a shame you have to construct a new DOMParser, specify “text/html”, and add “.body” to get the actual element. It would be perfect without those three oddities.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage3</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  container<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'&lt;div class="post">&lt;div class="message">'</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">'&lt;/div>&lt;/div>'</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>container<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Not sure if this is better or worse. I think it might be easier to explain what’s weird about it: we create a temporary throwaway div element to build inside, then use its contents. Our students already have to learn what innerHTML does so it’s not an additional load.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage4</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> postElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createContextualFragment</span><span class="token punctuation">(</span><span class="token string">'&lt;div class="post">&lt;div class="message">'</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">'&lt;/div>&lt;/div>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>postElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>My favourite so far. It avoids any “.firstChild” weirdness and returns the element we asked for. It unfortunately introduces a bunch of nonsense words (range? contextual fragment?!?) but it’s all on one line, so we can handwave it and say “it makes some HTML”.</p>
<p>Any of these will be better with template literals (template strings), so we can have line breaks in the HTML template:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage5</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> postElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createContextualFragment</span><span class="token punctuation">(</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class="post">
        &lt;div class="message"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div>
    &lt;/div>
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>postElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Like everything, this is a tradeoff. Template literals are very different from normal strings, and teaching beginners both too closely together will add cognitive load. Should we use normal strings instead, broken into multiple lines?</p>
<pre class="language-javascript"><code class="language-javascript">    <span class="token string">'&lt;div class="post">'</span> <span class="token operator">+</span>
    <span class="token string">'    &lt;div class="message">'</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">'&lt;/div>'</span> <span class="token operator">+</span>
    <span class="token string">'&lt;/div>'</span></code></pre>
<p>They’ll make more mistakes with this version, but… good mistakes. You’ll never regret becoming a string expert.</p>
<p>I think my fav is version 5, but multiline strings instead of template literals.</p>
<p>Then later in the course, when we learn about using functions to avoid duplicate code, we could hide <code>document.createRange().createContextualFragment</code> inside a nicely named utility function.</p>
<h3 id="update">Update</h3>
<p>Alexey points out that you don’t need to create an HTML element if you append plain text HTML to the parent node’s inner HTML. That would come out like this:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">displayMessage6</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> postHtml <span class="token operator">=</span> 
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div class="post">
        &lt;div class="message"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div>
    &lt;/div>
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> messageList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".message-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messageList<span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> postHtml<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This is better. I didn’t think of this because I was looking up way to “create an HTML element”, which we don’t explicitly do here. It has a few limitations, but it’s simple and probably the best option for our course.</p>

  </div>
	<footer>
	
  
<a href="/journal/2020-11-30-week-1/" title="Weekly thoughts - 1&nbsp;of&nbsp;6">Newer</a> &nbsp; 
  <a href="/journal/2018-01-04-no-tv/" title="No TV">Older</a>

		<footer>
		<div class="breadcrumbs">
	
			<a href="/">Home</a>
			<span class="subtle">&rarr;</span> 
			<a href="/journal/">Journal</a>
			<span class="subtle">&rarr;</span> 
			<span class="subtle">Learning JavaScript without JQuery</span>
	
		</div>
	</footer>
	</footer>
</section>
</body>
</html>